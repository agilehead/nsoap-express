{"version":3,"sources":["../src/nsoap-express.js"],"names":["app","options","_urlPrefix","urlPrefix","endsWith","req","res","next","body","path","url","query","headers","startsWith","strippedPath","substring","length","dicts","parseHeaders","parseQuery","parseBody","index","args","then","result","status","send","json","error"],"mappings":";;;;;;kBAEe,UAASA,GAAT,EAA4B;AAAA,MAAdC,OAAc,uEAAJ,EAAI;;AACzC,MAAMC,aAAaD,QAAQE,SAAR,IAAqB,GAAxC;AACA,MAAMA,YAAYD,WAAWE,QAAX,CAAoB,GAApB,IAA2BF,UAA3B,GAA2CC,SAA3C,MAAlB;;AAEA,SAAO,UAACE,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzB,QAAMC,OAAOP,QAAQO,IAAR,GAAeP,QAAQO,IAAR,CAAaH,GAAb,CAAf,GAAmCA,IAAIG,IAApD;AADyB,QAEjBC,IAFiB,GAEaJ,GAFb,CAEjBI,IAFiB;AAAA,QAEXC,GAFW,GAEaL,GAFb,CAEXK,GAFW;AAAA,QAENC,KAFM,GAEaN,GAFb,CAENM,KAFM;AAAA,QAECC,OAFD,GAEaP,GAFb,CAECO,OAFD;;AAGzB,QAAIH,KAAKI,UAAL,CAAgBV,SAAhB,CAAJ,EAAgC;AAC9B,UAAMW,eAAeL,KAAKM,SAAL,CAAeZ,UAAUa,MAAzB,CAArB;AACA,UAAMC,QAAQ,CACZhB,QAAQiB,YAAR,GAAuBjB,QAAQiB,YAAR,CAAqBN,OAArB,CAAvB,GAAuDA,OAD3C,EAEZX,QAAQkB,UAAR,GAAqBlB,QAAQkB,UAAR,CAAmBR,KAAnB,CAArB,GAAiDA,KAFrC,EAGZV,QAAQmB,SAAR,GAAoBnB,QAAQmB,SAAR,CAAkBZ,IAAlB,CAApB,GAA8CA,IAHlC,CAAd;;AAMA,2BAAMR,GAAN,EAAWc,YAAX,EAAyBG,KAAzB,EAAgC;AAC9BI,eAAOpB,QAAQoB,KAAR,IAAiB,OADM;AAE9BC,cAAM,CAACjB,GAAD,EAAMC,GAAN,EAAW,EAAX;AAFwB,OAAhC,EAGGiB,IAHH,CAIE;AAAA,eACE,OAAOC,MAAP,KAAkB,QAAlB,GACIlB,IAAImB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,MAArB,CADJ,GAEIlB,IAAImB,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqBH,MAArB,CAHN;AAAA,OAJF,EAQE;AAAA,eAASlB,IAAImB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBE,KAArB,CAAT;AAAA,OARF;AAUD,KAlBD,MAkBO;AACLrB;AACD;AACF,GAxBD;AAyBD,C;;AA/BD","file":"nsoap-express.js","sourcesContent":["import nsoap from \"nsoap\";\n\nexport default function(app, options = {}) {\n  const _urlPrefix = options.urlPrefix || \"/\";\n  const urlPrefix = _urlPrefix.endsWith(\"/\") ? _urlPrefix : `${urlPrefix}/`;\n\n  return (req, res, next) => {\n    const body = options.body ? options.body(req) : req.body;\n    const { path, url, query, headers } = req;\n    if (path.startsWith(urlPrefix)) {\n      const strippedPath = path.substring(urlPrefix.length);\n      const dicts = [\n        options.parseHeaders ? options.parseHeaders(headers) : headers,\n        options.parseQuery ? options.parseQuery(query) : query,\n        options.parseBody ? options.parseBody(body) : body\n      ];\n\n      nsoap(app, strippedPath, dicts, {\n        index: options.index || \"index\",\n        args: [req, res, {}]\n      }).then(\n        result =>\n          typeof result === \"string\"\n            ? res.status(200).send(result)\n            : res.status(200).json(result),\n        error => res.status(400).send(error)\n      );\n    } else {\n      next();\n    }\n  };\n}\n"]}